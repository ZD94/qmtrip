<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>差率费用报销单</title>
	<link rel="stylesheet" href="bootstrap.min.css">
	<style>
		html {
			transform: scale(0.75);
			-webkit-transform: scale(0.75);
			transform-origin: 0 0;
			-webkit-transform-origin: 0 0;
			height: 0;
		}
	</style>
	<style>
	.content {
		width: 210mm;
		height:287mm;
		color: #454545;
		padding:15mm 14mm 5mm 17mm;
		text-align: center;
		font-size: 9pt;
		font-family: 'AR PL UKai CN', 'KaiTi','sans-serif',  'Arial', 'STKaiti';
		margin:0 auto;
		position:relative;
	}
	.content h1 {
		font-size: 12pt;
	}
	.content p.date {
		text-align: right;
	}
	.content table {
		margin: 0 auto;
	}
	.content table.first-table {
		width: 178mm;
		border-left: none;
		border-right: none;
	}
	.content table.first-table tr {
		height: 18pt;
		border-left: none;
		border-right: none;
	}
	.content table.first-table tr td:first-child{
		border-left: none;
	}
	.content table.first-table tr td:last-child{
		border-right: none;
	}
	.content table.first-table tr td span:nth-child(1) {
		float: left;
	}
	.content table.first-table tr td span:nth-child(2) {
		float: right;
	}
	.content table.second-table {
		width: 178mm;
		text-align: left;
	}
	.content table.second-table tbody > tr > td {
		border-top: none;
	}
	.content table.second-table tr {
		height: 12pt;
	}
	.content table.second-table tr.total {
		border-top: 2pt solid #222222;
		border-bottom: 2pt solid #222222;
		font-weight: bold;
	}
	.content .content-middle {
		overflow: hidden;
	}
	.content .content-middle h3 {
		text-align: left;
		font-size: 10pt;
		padding-left: 12pt;
	}
	.content .content-middle .detail {
		float: left;
		width: 90mm;
	}
	.content .content-middle .detail div.container {
		width: 100%;
	}
	.content .content-middle .detail div.container .col-xs-6 span:nth-child(1) {
		float: left;
	}
	.content .content-middle .detail div.container .col-xs-6 span:nth-child(2) {
		float: right;
	}
	.content .content-middle .detail div.container .col-xs-6:nth-child(1) {
		padding-right: 0pt;
	}
	.content .content-middle .explain {
		width: 85mm;
		float: right;
		margin-right: 9pt;
	}
	.content .content-middle .explain h3 {
		padding-left: 75pt;
	}
	.content .content-middle .explain .qrcode {
		float: left;
	}
	.content .content-middle .explain .explain-text {
		float: right;
		width: 58mm;
	}
	.content .content-middle .explain .explain-text div {
		border-bottom: 1pt solid #cdcdcd;
		height: 18pt;
	}
	.content .content-middle .sign {
		clear: both;
		padding-top: 20px;
		font-weight: bold;
	}
	.content .content-middle .sign .col-xs-3 {
		padding-left: 0px;
		padding-right: 0px;
		margin-right: 0px;
		margin-left: 0px;
	}
	.content .ticket {
		border: 2px solid #8cb8e1;
		width: 170mm;
		/*height: 130mm;*/
		margin: 0mm auto 0mm;
		padding-bottom: 20mm;
		position:absolute;
		top:55%;
		left:10%;
	}
	.content .ticket .ticket-title {
		font-size: 12pt;
		font-weight: bold;
		text-align: left;
		margin-top: 20pt;
		margin-bottom: 30mm;
		text-indent: 4pt;
	}
	.content .ticket table {
		width: 260pt;
	}
	.content .ticket table thead {
		background-color: #d9d9d9;
		border-top: 1pt solid #222222;
	}
	.content .ticket table tbody tr > td {
		border-top: none;
	}
	.content .ticket table tbody tr {
		border-top: 1pt dashed #222222;
	}
	.content .ticket table tbody tr:last-child {
		border-bottom: 1pt solid #222222;
	}
	.content .ticket .ticket-inform {
		color: #b4b4b4;
		margin-top: 40mm;
	}
	* {
		-webkit-box-sizing: border-box;
		-moz-box-sizing: border-box;
		/* box-sizing: border-box; */
	}
	h2, .h2, h3, .h3 {
		margin-top: 20px;
		margin-bottom: 10px;
	}
	p {
		margin: 0 0 10px;
	}
	</style>
</head>
<body>
<div class="content">
	<h1>差旅费用报销单</h1>
	<p class="date">日期：<%=data.createAt%></p>
	<table class="first-table table table-bordered">
		<tr>
			<td>
				<span>提交人</span><span><%=data.submitter%></span>
			</td>
			<td>
				<span>部门</span><span><%=data.department%></span>
			</td>
			<td>
				<span>金额</span><span><%=data.totalMoney%></span>
			</td>
		</tr>
		<tr>
			<td>
				<span>出差日期</span><span><%=data.departDate%>-<%=data.backDate%></span>
			</td>
			<td>
				<span>出差路线</span>
				<%
					var invoices = data.invoices;
					var begin = end = false;
					var departCity = '';
					var arrivalCity = '';
					var arrivalCity_last = '';
					_.forEach(invoices,function(invoice){
						if(invoice.type == '交通' && invoice.trafficType =='GO'){
							departCity = invoice.departCity;
							arrivalCity = invoice.arrivalCity;
							begin = true;
						}
						if(invoice.type == '交通' && invoice.trafficType =='BACK'){
							arrivalCityLast = invoice.arrivalCity;
							end = true;
						}
					})
					if(begin && end){
				%>
					<span><%= departCity%>-<%= arrivalCity%>-<%= arrivalCityLast%></span>
				<%
					}
				%>

				
			</td>
			<td>
				<span>项目编号/事由</span><span><%=data.reason%></span>
			</td>
		</tr>
	</table>
	<table class="table second-table">
		<thead>
			<tr>
				<th>类型</th>
				<th>发票日期</th>
				<th>明细</th>
				<th>数量</th>
				<th>金额</th>
				<th>费用说明</th>
			</tr>
		</thead>
		<tbody>
			<%
				var invoices = data.invoices;
				_.forEach(invoices,function(invoice){
			%>		
			<tr style="border-top:1px dashed #222222">
				<td><%=invoice.type%></td>
				<td><%=invoice.date%></td>
				<td><%=invoice.invoiceInfo%></td>
				<td><%=invoice.quantity%>张</td>
				<td><%=invoice.money%></td>
				<td><%=invoice.remark%></td>
			</tr>
			<%
				})
			%>
			<tr class="total">
				<td colspan="3">合计人民币(大写:)<%=data.totalMoneyHZ%></td>
				<td colspan="2"><%=data.invoiceQuantity%>张</td>
				<td><%=data.totalMoney%>元</td>
			</tr>
		</tbody>
	</table>
	<div class="content-middle">
		<div class="detail">
			<h3>预算详情</h3>
			<div class="container">					
				<div class="row">
					<%
						var invoices = data.invoices;
						_.forEach(invoices,function(invoice){
							if(invoice.type == '交通' && invoice.trafficType =='GO'){
								var goMoney = invoice.money
								var goTrafficInfo = invoice.trafficInfo
					%>
					<div class="col-xs-6">
						<span>去程(<%= goTrafficInfo%>)</span><span><%= goMoney%></span>
					</div>
					<%
							}
						    if(invoice.type == '交通' && invoice.trafficType =='BACK'){
								var backMoney = invoice.money
								var backTrafficInfo = invoice.trafficInfo						    	
					%>
					<div class="col-xs-6">
						<span>返程(<%= backTrafficInfo%>)</span><span><%= backMoney%></span>
					</div>
					<%
							}
						})
					%>
				</div>
				<div class="row">
					<div class="col-xs-6">							
					<%
						var invoices = data.invoices;
						var flag = false;
						_.forEach(invoices,function(invoice){
							if(invoice.type == '住宿'){
								var stayMoney = invoice.money
								var stayTime = invoice.duration
								flag = true;
					%>
						<span>住宿(<%= stayTime%>天)</span>
						<span style="float:right">	
							<%=stayMoney%>
						</span>
					<%	
							}
						})
						if(!flag){
					%>
						<span>住宿</span>
						<span>无</span>					
					<%	
						}
					%>		
					</div>				
					<div class="col-xs-6">
						<span>总预算</span><span><%=data.budgetMoney%></span>
					</div>
				</div>
				
				<div class="row">
					<div class="col-xs-6">
						<span>实际支出</span><span><%=data.totalMoney%></span>
					</div>
					<div class="col-xs-6">
						<span>节省</span><span><%=_.round((data.budgetMoney-data.totalMoney),1)%></span>
					</div>
				</div>
				<div class="row">
					<div class="col-xs-6">
						<span>审批人:</span>
						
						<%
							var approveUsers = _(data.approveUsers)
								.map( approveUser => approveUser)
								.join("、");
						%>
						<span><%=approveUsers%></span>
						<%	
						%>
						
					</div>
					<div class="col-xs-6"></div>
				</div>
			</div>
		</div>
		<div class="explain">
			<h3>超支说明</h3>
			<div class="qrcode">
				<img src="<%=data.qrcode%>" width="80pt">
				<div style="font-size:7pt">查看预算详情</div>
			</div>
			<div class="explain-text">				
				<div></div>
				<div></div>
				<div></div>
			</div>
		</div>
		<div class="sign">
			<div class="row"  style="padding-left:15px">
				<div class="col-xs-3">总经理:____________</div>
				<div class="col-xs-3">审批人:_____________</div>
				<div class="col-xs-3">财务审核:_____________</div>
				<div class="col-xs-3">提交人签字:____________</div>
			</div>
		</div>
	</div>
	<div class="ticket">
		<p class="ticket-title">
			在此区域贴票
		</p>
		<table class="table">
			<thead>
				<tr>
					<td>序号</td>
					<td>类别</td>
					<td>金额</td>
					<td>发票日期</td>
				</tr>
			</thead>
			<tbody>
				<%
					var invoices = data.invoices;
					var index=1;
					_.forEach(invoices,function(invoice){
				%>
					<tr>
						<td><%=index%></td>
						<td><%=invoice.invoiceInfo%></td>
						<td><%=invoice.money%></td>
						<td><%=invoice.date%></td>
					</tr>
				<%	
					index++;	
					})					
				%>
			</tbody>
		</table>
	</div>
</div>
</body>
</html>