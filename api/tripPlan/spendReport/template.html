<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>差率费用报销单</title>
	<link rel="stylesheet" href="bootstrap.min.css">
	<style>
		html {
			transform: scale(0.75);
			-webkit-transform: scale(0.75);
			transform-origin: 0 0;
			-webkit-transform-origin: 0 0;
			height: 0;
		}
	</style>
	<style>
		body {
			font-family: 'AR PL UKai CN', 'KaiTi','sans-serif',  'Arial', 'STKaiti';
			width: 210mm;
		}
		.content {
			width: 210mm;
			height:287mm;
			color: #454545;
			padding:10mm 14mm 5mm 17mm;
			text-align: center;
			font-size: 9pt;
			font-family: 'AR PL UKai CN', 'KaiTi','sans-serif',  'Arial', 'STKaiti';
			margin:0 auto;
			position:relative;
		}
		.content h1 {
			font-size: 12pt;
		}
		.content p.date {
			text-align: right;
		}
		.content table {
			margin: 0 auto;
		}
		.content table.first-table {
			width: 178mm;
			border-left: none;
			border-right: none;
		}
		.content table.first-table tr {
			height: 18pt;
			border-left: none;
			border-right: none;
		}

		.content table.first-table tr td span:nth-child(1) {
			float: left;
		}
		.content table.first-table tr td span:nth-child(2) {
			float: right;
		}
		.content table.second-table {
			width: 178mm;
			text-align: left;
            margin-top: 24pt;
		}
		.content table.second-table tbody > tr > td {
			border-top: none;
		}
		.content table.second-table tr {
			height: 12pt;
		}
		.content table.second-table tr.total {
			border-top: 2pt solid #000000;
			border-bottom: 2pt solid #000000;
			font-weight: bold;
		}
		.content .content-middle {
			overflow: hidden;
		}
		.content .content-middle h3 {
			text-align: left;
			font-size: 12pt;
			padding-left: 12pt;
		}
		.content .content-middle .detail {
			float: right;
			width: 40mm;
			margin-top: 14pt
		}
		.content .content-middle .detail p{
			text-align: left;
			font-size: 12pt;
			margin-bottom: 0px;
		}
		.content .content-middle .detail p:first-child{
			margin-bottom: 9pt;
		}
		/*	.content .content-middle .detail div.container {
                width: 100%;
            }
            .content .content-middle .detail div.container .col-xs-6 span:nth-child(1) {
                float: left;
            }
            .content .content-middle .detail div.container .col-xs-6 span:nth-child(2) {
                float: right;
            }
            .content .content-middle .detail div.container .col-xs-6:nth-child(1) {
                padding-right: 0pt;
            }*/
		.content .content-middle .explain {
			width: 120mm;
			float: left;
			margin-right: 9pt;
		}
		.content .content-middle .explain h3 {
			padding-left: 0pt;
			margin-top: 14pt;
		}
		.content .content-middle .explain .qrcode {
			float: left;
			padding-top: 14pt;
		}
		.content .content-middle .explain .explain-text {
			float: right;
			width: 90mm;
		}
		.content .content-middle .explain .explain-text div {
			border-bottom: 1pt solid #222;
			height: 18pt;
		}
		.content .content-middle .sign {
			clear: both;
			/*width: 40mm;*/
			/*float: right;*/
			padding-top: 20px;
			font-weight: bold;
		}
		.content .content-middle .sign .col-xs-3 {
			padding-left: 0px;
			padding-right: 0px;
			margin-right: 0px;
			margin-left: 0px;
		}
		.content .ticket {
			border: 2px solid #8cb8e1;
			width: 170mm;
			/*height: 130mm;*/
			margin: 0mm auto 0mm;
			padding-bottom: 20mm;
			position:absolute;
			top:55%;
			left:10%;
		}
		.content .ticket .ticket-title {
			font-size: 12pt;
			font-weight: bold;
			text-align: left;
			margin-top: 20pt;
			margin-bottom: 30mm;
			text-indent: 4pt;
		}
		.content .ticket table {
			width: 260pt;
		}
		.content .ticket table thead {
			background-color: #d9d9d9;
			border-top: 1pt solid #000000;
		}
		.content .ticket table tbody tr > td {
			border-top: none;
		}
		.content .ticket table tbody tr {
			border-top: 1pt dashed #000000;
		}
		.content .ticket table tbody tr:last-child {
			border-bottom: 1pt solid #000000;
		}
		.content .ticket .ticket-inform {
			color: #b4b4b4;
			margin-top: 40mm;
		}
		* {
			-webkit-box-sizing: border-box;
			-moz-box-sizing: border-box;
			/* box-sizing: border-box; */
		}
		h2, .h2, h3, .h3 {
			margin-top: 20px;
			margin-bottom: 10px;
		}
		p {
			margin: 0 0 10px;
		}
	</style>
</head>
<body>
<div class="content">
	<h1>差旅费用报销单</h1>
	<div class="row">
		<div class="col-xs-8" style="text-align: left;">
			<span>提交人：</span><span><%=data.submitter%></span>
			<span>部门：</span><span><%=data.department%></span>
		</div>
		<div class="col-xs-4" style="text-align: right;">
			<span>日期:<%=data.createAt%></span>
		</div>
	</div>
	<table class="first-table table table-bordered">
		<tr>
			<td>
				<span>总预算</span><span><%=data.budgetMoney.toFixed(0)%></span>
			</td>
			<td colspan="2">
				<span>总支出</span><span><%=data.totalMoney%></span>
			</td>
		</tr>
		<tr>
			<td>
				<span>出差日期</span><span><%=data.departDate%>-<%=data.backDate%></span>
			</td>
			<td>
				<span>出差路线</span>
					<span><%=data.roundLine%></span>
			</td>
			<td>
				<span>项目名称</span><span><%=data.reason%></span>
			</td>
		</tr>
		<tr>
			<td colspan="3">
				<span>出差人</span>
				<span><%=data.submitter%></span>
			</td>
		</tr>
	</table>
    <div class="content-middle">
        <div class="explain">
            <div class="qrcode">
                <img src="<%=data.qrcode%>" width="100pt">
                <div style="font-size:7pt">查看预算详情</div>
            </div>

            <div class="explain-text">
                <h3>超支说明</h3>
                <div></div>
                <div></div>
                <div></div>
            </div>
        </div>
        <div class="detail">
            <p>预算审批人</p>
            <%_.forEach(data.approveUsers, function(user) {%>
            <p><%=user%></p>
            <%})%>
        </div>
        <div class="sign">
            <div class="row"  style="padding-left:15px">
                <div class="col-xs-3">总经理:____________</div>
                <div class="col-xs-3">审批人:_____________</div>
                <div class="col-xs-3">财务审核:_____________</div>
                <div class="col-xs-3">提交人签字:____________</div>
            </div>
        </div>
    </div>
	<table class="table second-table">
		<thead>
			<tr>
				<th>类型</th>
				<th>发票日期</th>
				<th>明细</th>
				<th>数量</th>
				<th>金额</th>
				<th>费用说明</th>
			</tr>
		</thead>
		<tbody>
			<%
				var invoices = data.invoices;
				_.forEach(invoices,function(invoice){
			%>		
			<tr style="border-top:1px dashed #000000">
				<td><%=invoice.type%></td>
				<td><%=(invoice.type=== '补助' ? '-': invoice.date)%></td>
				<td><%=invoice.invoiceInfo%></td>
				<td><%=(invoice.type=== '补助' ? '-': invoice.quantity+'张')%></td>
				<td><%=invoice.money%></td>
				<td><%=invoice.remark%></td>
			</tr>
			<%
				})
			%>
			<tr class="total">
				<td colspan="3">合计人民币(大写:)<%=data.totalMoneyHZ%></td>
				<td colspan="2"><%=data.invoiceQuantity%>张</td>
				<td><%=data.totalMoney%>元</td>
			</tr>
		</tbody>
	</table>
</div>
</body>
</html>
