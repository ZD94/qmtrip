<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>差率费用报销单</title>
	<style>
		* {
		margin:0px;
		padding: 0px
	}
	table {
		border-spacing: 0;
		border-collapse: collapse;
	}
	.table {
		border-collapse: collapse !important;
	}
	.table-bordered th,
	.table-bordered td {
		border: 1px solid #ddd;
	}
	table {
		background-color: transparent;
	}
	.table {
		width: 100%;
		max-width: 100%;
		margin-bottom: 20px;
	}
	.table > thead > tr > th,
	.table > tbody > tr > th,
	.table > tfoot > tr > th,
	.table > thead > tr > td,
	.table > tbody > tr > td,
	.table > tfoot > tr > td {
		padding: 8px;
		line-height: 1.42857143;
		vertical-align: top;
		border-top: 1px solid #ddd;
	}
	.table > thead > tr > th {
		vertical-align: bottom;
		border-bottom: 2px solid #ddd;
	}
	.table > caption + thead > tr:first-child > th,
	.table > colgroup + thead > tr:first-child > th,
	.table > thead:first-child > tr:first-child > th,
	.table > caption + thead > tr:first-child > td,
	.table > colgroup + thead > tr:first-child > td,
	.table > thead:first-child > tr:first-child > td {
		border-top: 0;
	}
	.table > tbody + tbody {
		border-top: 2px solid #ddd;
	}
	.table .table {
		background-color: #fff;
	}
	.table-condensed > thead > tr > th,
	.table-condensed > tbody > tr > th,
	.table-condensed > tfoot > tr > th,
	.table-condensed > thead > tr > td,
	.table-condensed > tbody > tr > td,
	.table-condensed > tfoot > tr > td {
		padding: 5px;
	}
	.table-bordered {
		border: 1px solid #ddd;
	}
	.table-bordered > thead > tr > th,
	.table-bordered > tbody > tr > th,
	.table-bordered > tfoot > tr > th,
	.table-bordered > thead > tr > td,
	.table-bordered > tbody > tr > td,
	.table-bordered > tfoot > tr > td {
		border: 1px solid #ddd;
	}
	.table-bordered > thead > tr > th,
	.table-bordered > thead > tr > td {
		border-bottom-width: 2px;
	}
	.table-striped > tbody > tr:nth-of-type(odd) {
		background-color: #f9f9f9;
	}
	.table-hover > tbody > tr:hover {
		background-color: #f5f5f5;
	}
	table col[class*="col-"] {
		position: static;
		display: table-column;
		float: none;
	}
	table td[class*="col-"],
	table th[class*="col-"] {
		position: static;
		display: table-cell;
		float: none;
	}
	.table > thead > tr > td.active,
	.table > tbody > tr > td.active,
	.table > tfoot > tr > td.active,
	.table > thead > tr > th.active,
	.table > tbody > tr > th.active,
	.table > tfoot > tr > th.active,
	.table > thead > tr.active > td,
	.table > tbody > tr.active > td,
	.table > tfoot > tr.active > td,
	.table > thead > tr.active > th,
	.table > tbody > tr.active > th,
	.table > tfoot > tr.active > th {
		background-color: #f5f5f5;
	}
	.table-hover > tbody > tr > td.active:hover,
	.table-hover > tbody > tr > th.active:hover,
	.table-hover > tbody > tr.active:hover > td,
	.table-hover > tbody > tr:hover > .active,
	.table-hover > tbody > tr.active:hover > th {
		background-color: #e8e8e8;
	}
	.table > thead > tr > td.success,
	.table > tbody > tr > td.success,
	.table > tfoot > tr > td.success,
	.table > thead > tr > th.success,
	.table > tbody > tr > th.success,
	.table > tfoot > tr > th.success,
	.table > thead > tr.success > td,
	.table > tbody > tr.success > td,
	.table > tfoot > tr.success > td,
	.table > thead > tr.success > th,
	.table > tbody > tr.success > th,
	.table > tfoot > tr.success > th {
		background-color: #dff0d8;
	}
	.table-hover > tbody > tr > td.success:hover,
	.table-hover > tbody > tr > th.success:hover,
	.table-hover > tbody > tr.success:hover > td,
	.table-hover > tbody > tr:hover > .success,
	.table-hover > tbody > tr.success:hover > th {
		background-color: #d0e9c6;
	}
	.table > thead > tr > td.info,
	.table > tbody > tr > td.info,
	.table > tfoot > tr > td.info,
	.table > thead > tr > th.info,
	.table > tbody > tr > th.info,
	.table > tfoot > tr > th.info,
	.table > thead > tr.info > td,
	.table > tbody > tr.info > td,
	.table > tfoot > tr.info > td,
	.table > thead > tr.info > th,
	.table > tbody > tr.info > th,
	.table > tfoot > tr.info > th {
		background-color: #d9edf7;
	}
	.table-hover > tbody > tr > td.info:hover,
	.table-hover > tbody > tr > th.info:hover,
	.table-hover > tbody > tr.info:hover > td,
	.table-hover > tbody > tr:hover > .info,
	.table-hover > tbody > tr.info:hover > th {
		background-color: #c4e3f3;
	}
	.table > thead > tr > td.warning,
	.table > tbody > tr > td.warning,
	.table > tfoot > tr > td.warning,
	.table > thead > tr > th.warning,
	.table > tbody > tr > th.warning,
	.table > tfoot > tr > th.warning,
	.table > thead > tr.warning > td,
	.table > tbody > tr.warning > td,
	.table > tfoot > tr.warning > td,
	.table > thead > tr.warning > th,
	.table > tbody > tr.warning > th,
	.table > tfoot > tr.warning > th {
		background-color: #fcf8e3;
	}
	.table-hover > tbody > tr > td.warning:hover,
	.table-hover > tbody > tr > th.warning:hover,
	.table-hover > tbody > tr.warning:hover > td,
	.table-hover > tbody > tr:hover > .warning,
	.table-hover > tbody > tr.warning:hover > th {
		background-color: #faf2cc;
	}
	.table > thead > tr > td.danger,
	.table > tbody > tr > td.danger,
	.table > tfoot > tr > td.danger,
	.table > thead > tr > th.danger,
	.table > tbody > tr > th.danger,
	.table > tfoot > tr > th.danger,
	.table > thead > tr.danger > td,
	.table > tbody > tr.danger > td,
	.table > tfoot > tr.danger > td,
	.table > thead > tr.danger > th,
	.table > tbody > tr.danger > th,
	.table > tfoot > tr.danger > th {
		background-color: #f2dede;
	}
	.table-hover > tbody > tr > td.danger:hover,
	.table-hover > tbody > tr > th.danger:hover,
	.table-hover > tbody > tr.danger:hover > td,
	.table-hover > tbody > tr:hover > .danger,
	.table-hover > tbody > tr.danger:hover > th {
		background-color: #ebcccc;
	}
	.table-responsive {
		min-height: .01%;
		overflow-x: auto;
	}
	@media screen and (max-width: 767px) {
		.table-responsive {
			width: 100%;
			margin-bottom: 15px;
			overflow-y: hidden;
			-ms-overflow-style: -ms-autohiding-scrollbar;
			border: 1px solid #ddd;
		}
		.table-responsive > .table {
			margin-bottom: 0;
		}
		.table-responsive > .table > thead > tr > th,
		.table-responsive > .table > tbody > tr > th,
		.table-responsive > .table > tfoot > tr > th,
		.table-responsive > .table > thead > tr > td,
		.table-responsive > .table > tbody > tr > td,
		.table-responsive > .table > tfoot > tr > td {
			white-space: nowrap;
		}
		.table-responsive > .table-bordered {
			border: 0;
		}
		.table-responsive > .table-bordered > thead > tr > th:first-child,
		.table-responsive > .table-bordered > tbody > tr > th:first-child,
		.table-responsive > .table-bordered > tfoot > tr > th:first-child,
		.table-responsive > .table-bordered > thead > tr > td:first-child,
		.table-responsive > .table-bordered > tbody > tr > td:first-child,
		.table-responsive > .table-bordered > tfoot > tr > td:first-child {
			border-left: 0;
		}
		.table-responsive > .table-bordered > thead > tr > th:last-child,
		.table-responsive > .table-bordered > tbody > tr > th:last-child,
		.table-responsive > .table-bordered > tfoot > tr > th:last-child,
		.table-responsive > .table-bordered > thead > tr > td:last-child,
		.table-responsive > .table-bordered > tbody > tr > td:last-child,
		.table-responsive > .table-bordered > tfoot > tr > td:last-child {
			border-right: 0;
		}
		.table-responsive > .table-bordered > tbody > tr:last-child > th,
		.table-responsive > .table-bordered > tfoot > tr:last-child > th,
		.table-responsive > .table-bordered > tbody > tr:last-child > td,
		.table-responsive > .table-bordered > tfoot > tr:last-child > td {
			border-bottom: 0;
		}
	}
	.table-bordered th,
	.table-bordered td {
		border: 1px solid #ddd;
	}
	.table-bordered {
		border: 1px solid #ddd;
	}
	.table-bordered > thead > tr > th,
	.table-bordered > tbody > tr > th,
	.table-bordered > tfoot > tr > th,
	.table-bordered > thead > tr > td,
	.table-bordered > tbody > tr > td,
	.table-bordered > tfoot > tr > td {
		border: 1px solid #ddd;
	}
	.table-bordered > thead > tr > th,
	.table-bordered > thead > tr > td {
		border-bottom-width: 2px;
	}
	</style>
	<style>

	.container:before,
	.container:after,
	.container-fluid:before,
	.container-fluid:after,
	.row:before,
	.row:after{
		display: table;
		content: " ";
	}
	.container:after,
	.row:after{
		clear:both;
	}
	.container {
		padding-right: 15px;
		padding-left: 15px;
		margin-right: auto;
		margin-left: auto;
	}

	.row {
		margin-right: -15px;
		margin-left: -15px;
	}
	.col-xs-1, .col-sm-1, .col-md-1, .col-lg-1, .col-xs-2, .col-sm-2, .col-md-2, .col-lg-2, .col-xs-3, .col-sm-3, .col-md-3, .col-lg-3, .col-xs-4, .col-sm-4, .col-md-4, .col-lg-4, .col-xs-5, .col-sm-5, .col-md-5, .col-lg-5, .col-xs-6, .col-sm-6, .col-md-6, .col-lg-6, .col-xs-7, .col-sm-7, .col-md-7, .col-lg-7, .col-xs-8, .col-sm-8, .col-md-8, .col-lg-8, .col-xs-9, .col-sm-9, .col-md-9, .col-lg-9, .col-xs-10, .col-sm-10, .col-md-10, .col-lg-10, .col-xs-11, .col-sm-11, .col-md-11, .col-lg-11, .col-xs-12, .col-sm-12, .col-md-12, .col-lg-12 {
		position: relative;
		min-height: 1px;
		padding-right: 15px;
		padding-left: 15px;
	}
	.col-xs-1, .col-xs-2, .col-xs-3, .col-xs-4, .col-xs-5, .col-xs-6, .col-xs-7, .col-xs-8, .col-xs-9, .col-xs-10, .col-xs-11, .col-xs-12 {
		float: left;
	}
	.col-xs-12 {
		width: 100%;
	}
	.col-xs-11 {
		width: 91.66666667%;
	}
	.col-xs-10 {
		width: 83.33333333%;
	}
	.col-xs-9 {
		width: 75%;
	}
	.col-xs-8 {
		width: 66.66666667%;
	}
	.col-xs-7 {
		width: 58.33333333%;
	}
	.col-xs-6 {
		width: 50%;
	}
	.col-xs-5 {
		width: 41.66666667%;
	}
	.col-xs-4 {
		width: 33.33333333%;
	}
	.col-xs-3 {
		width: 25%;
	}
	.col-xs-2 {
		width: 16.66666667%;
	}
	.col-xs-1 {
		width: 8.33333333%;
	}
	</style>
	<style>



	.content {
		width: 210mm;
		height:285mm;
		color: #454545;
		padding:15mm 14mm 15mm 17mm;
		text-align: center;
		font-size: 9pt;
		font-family: 'KaiTi','sans-serif',  'Arial', 'STKaiti';
		margin:0 auto;
		position:relative;
		transform: scale(0.75);
		-webkit-transform: scale(0.75);
		transform-origin: 0 0;
		-webkit-transform-origin:0 0 ;
	}
	.content h1 {
		font-size: 12pt;
	}
	.content p.date {
		text-align: right;
	}
	.content table {
		margin: 0 auto;
	}
	.content table.first-table {
		width: 178mm;
		border-left: none;
		border-right: none;
	}
	.content table.first-table tr {
		height: 18pt;
		border-left: none;
		border-right: none;
	}
	.content table.first-table tr td:first-child{
		border-left: none;
	}
	.content table.first-table tr td:last-child{
		border-right: none;
	}
	.content table.first-table tr td span:nth-child(1) {
		float: left;
	}
	.content table.first-table tr td span:nth-child(2) {
		float: right;
	}
	.content table.second-table {
		width: 178mm;
		text-align: left;
	}
	.content table.second-table tbody > tr > td {
		border-top: none;
	}
	.content table.second-table tr {
		height: 12pt;
	}
	.content table.second-table tr.total {
		border-top: 2pt solid #222222;
		border-bottom: 2pt solid #222222;
		font-weight: bold;
	}
	.content .content-middle {
		overflow: hidden;
	}
	.content .content-middle h3 {
		text-align: left;
		font-size: 10pt;
		padding-left: 12pt;
	}
	.content .content-middle .detail {
		float: left;
		width: 90mm;
	}
	.content .content-middle .detail div.container {
		width: 100%;
	}
	.content .content-middle .detail div.container .col-xs-6 span:nth-child(1) {
		float: left;
	}
	.content .content-middle .detail div.container .col-xs-6 span:nth-child(2) {
		float: right;
	}
	.content .content-middle .detail div.container .col-xs-6:nth-child(1) {
		padding-right: 0pt;
	}
	.content .content-middle .explain {
		width: 85mm;
		float: right;
		margin-right: 9pt;
	}
	.content .content-middle .explain h3 {
		padding-left: 75pt;
	}
	.content .content-middle .explain .qrcode {
		float: left;
	}
	.content .content-middle .explain .explain-text {
		float: right;
		width: 58mm;
	}
	.content .content-middle .explain .explain-text div {
		border-bottom: 1pt solid #cdcdcd;
		height: 18pt;
	}
	.content .content-middle .sign {
		clear: both;
		padding-top: 20px;
		font-weight: bold;
	}
	.content .content-middle .sign .col-xs-3 {
		padding-left: 0px;
		padding-right: 0px;
		margin-right: 0px;
		margin-left: 0px;
	}
	.content .ticket {
		border: 2px solid #8cb8e1;
		width: 170mm;
		/*height: 130mm;*/
		margin: 0mm auto 0mm;
		padding-bottom: 20mm;
		position:absolute;
		top:55%;
		left:10%;
	}
	.content .ticket .ticket-title {
		font-size: 12pt;
		font-weight: bold;
		text-align: left;
		margin-top: 20pt;
		margin-bottom: 30mm;
		text-indent: 4pt;
	}
	.content .ticket table {
		width: 260pt;
	}
	.content .ticket table thead {
		background-color: #d9d9d9;
		border-top: 1pt solid #222222;
	}
	.content .ticket table tbody tr > td {
		border-top: none;
	}
	.content .ticket table tbody tr {
		border-top: 1pt dashed #222222;
	}
	.content .ticket table tbody tr:last-child {
		border-bottom: 1pt solid #222222;
	}
	.content .ticket .ticket-inform {
		color: #b4b4b4;
		margin-top: 40mm;
	}
	* {
		-webkit-box-sizing: border-box;
		-moz-box-sizing: border-box;
		/* box-sizing: border-box; */
	}
	h2, .h2, h3, .h3 {
		margin-top: 20px;
		margin-bottom: 10px;
	}
	p {
		margin: 0 0 10px;
	}
	</style>
</head>
<body>
<div class="content">
	<h1>差旅费用报销单</h1>
	<p class="date">日期：<%=data.createAt%></p>
	<table class="first-table table table-bordered">
		<tr>
			<td>
				<span>提交人</span><span><%=data.submitter%></span>
			</td>
			<td>
				<span>部门</span><span><%=data.department%></span>
			</td>
			<td>
				<span>金额</span><span><%=data.totalMoney%></span>
			</td>
		</tr>
		<tr>
			<td>
				<span>出差日期</span><span><%=data.departDate%>-<%=data.backDate%></span>
			</td>
			<td>
				<span>出差路线</span>
				<%
					var invoices = data.invoices;
					var begin = end = false;
					var departCity = '';
					var arrivalCity = '';
					var arrivalCity_last = '';
					_.forEach(invoices,function(invoice){
						if(invoice.type == '交通' && invoice.trafficType =='GO'){
							departCity = invoice.departCity;
							arrivalCity = invoice.arrivalCity;
							begin = true;
						}
						if(invoice.type == '交通' && invoice.trafficType =='BACK'){
							arrivalCityLast = invoice.arrivalCity;
							end = true;
						}
					})
					if(begin && end){
				%>
					<span><%= departCity%>-<%= arrivalCity%>-<%= arrivalCityLast%></span>
				<%
					}
				%>

				
			</td>
			<td>
				<span>项目编号/事由</span><span><%=data.reason%></span>
			</td>
		</tr>
	</table>
	<table class="table second-table">
		<thead>
			<tr>
				<th>类型</th>
				<th>发票日期</th>
				<th>明细</th>
				<th>数量</th>
				<th>金额</th>
				<th>费用说明</th>
			</tr>
		</thead>
		<tbody>
			<%
				var invoices = data.invoices;
				_.forEach(invoices,function(invoice){
			%>		
			<tr style="border-top:1px dashed #222222">
				<td><%=invoice.type%></td>
				<td><%=invoice.date%></td>
				<td><%=invoice.invoiceInfo%></td>
				<td><%=invoice.quantity%>张</td>
				<td><%=invoice.money%></td>
				<td><%=invoice.remark%></td>
			</tr>
			<%
				})
			%>
			<tr class="total">
				<td colspan="3">合计人民币(大写:)<%=data.totalMoneyHZ%></td>
				<td colspan="2"><%=data.invoiceQuantity%>张</td>
				<td><%=data.totalMoney%>元</td>
			</tr>
		</tbody>
	</table>
	<div class="content-middle">
		<div class="detail">
			<h3>预算详情</h3>
			<div class="container">					
				<div class="row">
					<%
						var invoices = data.invoices;
						_.forEach(invoices,function(invoice){
							if(invoice.type == '交通' && invoice.trafficType =='GO'){
								var goMoney = invoice.money
								var goTrafficInfo = invoice.trafficInfo
					%>
					<div class="col-xs-6">
						<span>去程(<%= goTrafficInfo%>)</span><span><%= goMoney%></span>
					</div>
					<%
							}
						    if(invoice.type == '交通' && invoice.trafficType =='BACK'){
								var backMoney = invoice.money
								var backTrafficInfo = invoice.trafficInfo						    	
					%>
					<div class="col-xs-6">
						<span>返程(<%= backTrafficInfo%>)</span><span><%= backMoney%></span>
					</div>
					<%
							}
						})
					%>
				</div>
				<div class="row">
					<div class="col-xs-6">							
					<%
						var invoices = data.invoices;
						var flag = false;
						_.forEach(invoices,function(invoice){
							if(invoice.type == '住宿'){
								var stayMoney = invoice.money
								var stayTime = invoice.duration
								flag = true;
					%>
						<span>住宿(<%= stayTime%>天)</span>
						<span style="float:right">	
							<%=stayMoney%>
						</span>
					<%	
							}
						})
						if(!flag){
					%>
						<span>住宿</span>
						<span>无</span>					
					<%	
						}
					%>		
					</div>				
					<div class="col-xs-6">
						<span>总预算</span><span><%=data.budgetMoney%></span>
					</div>
				</div>
				
				<div class="row">
					<div class="col-xs-6">
						<span>实际支出</span><span><%=data.totalMoney%></span>
					</div>
					<div class="col-xs-6">
						<span>节省</span><span><%=_.round((data.budgetMoney-data.totalMoney),1)%></span>
					</div>
				</div>
				<div class="row">
					<div class="col-xs-6">
						<span>审批人:</span>
						
						<%
							var approveUsers = _(data.approveUsers)
								.map( approveUser => approveUser)
								.join("、");
						%>
						<span><%=approveUsers%></span>
						<%	
						%>
						
					</div>
					<div class="col-xs-6"></div>
				</div>
			</div>
		</div>
		<div class="explain">
			<h3>超支说明</h3>
			<div class="qrcode">
				<img src="<%=data.qrcode%>" width="80pt">
				<div style="font-size:7pt">查看预算详情</div>
			</div>
			<div class="explain-text">				
				<div></div>
				<div></div>
				<div></div>
			</div>
		</div>
		<div class="sign">
			<div class="row"  style="padding-left:15px">
				<div class="col-xs-3">总经理:____________</div>
				<div class="col-xs-3">审批人:_____________</div>
				<div class="col-xs-3">财务审核:_____________</div>
				<div class="col-xs-3">提交人签字:____________</div>
			</div>
		</div>
	</div>
	<div class="ticket">
		<p class="ticket-title">
			在此区域贴票
		</p>
		<table class="table">
			<thead>
				<tr>
					<td>序号</td>
					<td>类别</td>
					<td>金额</td>
					<td>发票日期</td>
				</tr>
			</thead>
			<tbody>
				<%
					var invoices = data.invoices;
					var index=1;
					_.forEach(invoices,function(invoice){
				%>
					<tr>
						<td><%=index%></td>
						<td><%=invoice.invoiceInfo%></td>
						<td><%=invoice.money%></td>
						<td><%=invoice.date%></td>
					</tr>
				<%	
					index++;	
					})					
				%>
			</tbody>
		</table>
	</div>
</div>
</body>
</html>