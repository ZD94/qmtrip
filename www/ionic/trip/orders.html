<ion-view title="关联订单">
    <ion-content padding="false" scroll="false" class="ordersFromSupplier">
        <div class="flex-c10">
            <ion-scroll>
                <div class="explanation">
                    说明:
                    <br/>
                    每个携程商旅的订单只允许和一个出差记录进行关联，如需修改请到出差记录中删除关联订单的记录，再重新回到此页面进行关联。已经完成审核的记录中，关联订单无法删除。
                </div>
                <ion-list>
                    <ion-item>
                        <img class="" ng-src="/attachments/{{supplier.logo}}" ng-if="supplier.logo">
                        <div class="button-bar">
                            <a class="button button-small button-positive"
                               ng-class="{'button-outline':!orderBinded}" ng-click="getOrders('alreadyBind')">已关联</a>
                            <a class="button button-small button-positive"
                               ng-class="{'button-outline':orderBinded}"
                               ng-click="getOrders('notBind')">未关联</a>
                        </div>
                    </ion-item>
                    <ion-checkbox ng-repeat="order in orders"
                                  ng-model="order.checked"
                                  ng-checked="order.checked"
                                  ng-if="!orderBinded"
                    >
                        <p>{{order.date | date: 'yyyy-MM-dd'}}</p>
                        <div class="order-detail">
                            <p>
                                <span ng-if="order.orderType == EInvoiceFeeTypes.PLANET_TICKET"> {{order.starCityName}}<i class="icon ion-plane"></i>{{order.endCityName}}</span>
                                <span ng-if="order.orderType == EInvoiceFeeTypes.TRAIN_TICKET"> {{order.starCityName}}<i class="icon ion-android-train"></i>{{order.endCityName}}</span>
                                <span ng-if="order.orderType == EInvoiceFeeTypes.HOTEL"> <i class="icon ion-home"></i>{{order.desc}}</span>
                                <span ng-if="order.orderType == EInvoiceFeeTypes.PLANET_TICKET"> {{order.number}}</span>
                                <span ng-if="order.orderType == EInvoiceFeeTypes.TRAIN_TICKET"> {{order.number}}</span>
                                <span class="order_price">{{order.price | currency_int: ''}}元</span>
                            </p>
                            <p>
                                <span class="people">
                                    {{order.orderType == EInvoiceFeeTypes.HOTEL ? '入住人' : '出行人'}}：{{order.persons.join()}}
                                </span>
                                <span class="pay-func company-pay" ng-if="order.parType == EPayType.COMPANY_PAY">
                                    公司账户支付
                                </span>
                                <span class="pay-func personal-pay" ng-if="order.parType == EPayType.PERSONAL_PAY">
                                    个人账户支付
                                </span>
                            </p>
                        </div>
                    </ion-checkbox>
                    <div ng-repeat="order in orders"
                         ng-model="order.checked"
                         ng-checked="order.checked"
                         ng-if="orderBinded"
                         class="item"
                    >
                        <p>{{order.date | date: 'yyyy-MM-dd'}}</p>
                        <p>
                            <span ng-if="order.orderType == EInvoiceFeeTypes.PLANET_TICKET"> {{order.starCityName}}<i class="icon ion-plane"></i>{{order.endCityName}}</span>
                            <span ng-if="order.orderType == EInvoiceFeeTypes.TRAIN_TICKET"> {{order.starCityName}}<i class="icon ion-android-train"></i>{{order.endCityName}}</span>
                            <span ng-if="order.orderType == EInvoiceFeeTypes.HOTEL"> <i class="icon ion-home"></i>{{order.desc}}</span>
                            <span ng-if="order.orderType == EInvoiceFeeTypes.PLANET_TICKET"> {{order.number}}</span>
                            <span ng-if="order.orderType == EInvoiceFeeTypes.TRAIN_TICKET"> {{order.number}}</span>
                            <span class="order_price">{{order.price | currency_int: ''}}元</span>
                        </p>
                        <p>
                            <span class="people">
                                {{order.orderType == EInvoiceFeeTypes.HOTEL ? '入住人' : '出行人'}}：{{order.persons.join()}}
                            </span>
                            <span class="pay-func company-pay" ng-if="order.parType == EPayType.COMPANY_PAY">
                                公司账户支付
                            </span>
                            <span class="pay-func personal-pay" ng-if="order.parType == EPayType.PERSONAL_PAY">
                                个人账户支付
                            </span>
                        </p>
                    </div>
                </ion-list>
            </ion-scroll>
            <div>
                <a id="page1-button26"
                   class="button button-positive button-full"
                   ng-click="selectOrders()"
                   ng-if="!orderBinded"
                   style="margin: 0;"
                >完成</a>
            </div>
        </div>
    </ion-content>
</ion-view>