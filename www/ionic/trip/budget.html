<ion-view title="预算结果" id="page16">
    <ion-content padding="false" scroll="false" class="has-header">
        <div class="flex-c10">
            <ion-scroll>
                <div id="page16-markdown4" style="color:#000000;text-align:right;">
                    <p style="color: #fff;">{{trip.createAt| date: 'yyyy-MM-dd HH:mm:ss'}}</p>
                </div>

                <ion-list class="jl_projectinfo">
                    <ion-item class="project_tit">{{trip.beginDate| date: 'MM-dd'}} 至 {{trip.endDate | date: 'MM-dd'}}
                        <span style="padding-left: 13px">{{trip.originPlaceName}} - {{trip.destinationPlaceName}}</span>
                    </ion-item>
                    <ion-item class="project_cont">
                        <p class="project_title" ng-if="trip && trip.beginDate"><i class="fa fa-flag-o">
                            </i>&nbsp;{{trip.reason || trip.reasonName}}</p>
                        <p class="totalBudget"  style="text-align: center">
                            <span>总预算</span>
                            <span ng-if="totalPrice && totalPrice > 0">
                                {{totalPrice| currency_int}}
                            </span>
                            <span ng-if="!totalPrice || totalPrice <= 0">
                                暂无预算
                            </span>
                        </p>
                    </ion-item>
                </ion-list>

                <div class="spacer budgetWrong">
                    <a ng-click="reportBudgetError()" >预算不合理?我要报错</a>
                </div>
                <ion-list>
                    <div ng-repeat="budget in budgets" class="ta-detail-item">
                        <ion-item class="item-divider">
                            <span ng-if='budget.tripType == ETripType.OUT_TRIP'>去程交通</span>
                            <span ng-if='budget.tripType == ETripType.BACK_TRIP'>回程交通</span>
                            <span ng-if='budget.tripType == ETripType.HOTEL'>住宿</span>
                            <span ng-if='budget.tripType == ETripType.SUBSIDY'>补助</span>
                            <!--<span style="float: right">{{budget.price == -1 ? '暂无预算' : (budget.price| currency: '')}}{{budget.price == -1 ? '' : '元'}}</span>-->
                        </ion-item>
                        <ion-item>
                            <div ng-if="budget.tripType == ETripType.BACK_TRIP">
                                <span>{{trip.endDate | date: 'MM-dd'}}</span>
                                <span class="spanRight">{{budget.price <=0 ? '暂无预算' : (budget.price| currency_int)+'元'}}</span>
                                <br/>
                                {{trip.destinationPlaceName}}
                                &nbsp;
                                <i ng-if='budget.type == EInvoiceType.PLANE' class="icon ion-plane"></i>
                                <i ng-if='budget.type == EInvoiceType.TRAIN' class="icon ion-android-train"></i>
                                <i ng-if='budget.type == EInvoiceType.HOTEL' class="icon ion-home"></i>
                                &nbsp;
                                {{trip.originPlaceName}}
                                <span class="spanRight right-budget">
                                    <span>{{budget.type == EInvoiceType.TRAIN ? MTrainLevel[budget.cabinClass] : MPlaneLevel[budget.cabinClass]}}</span>
                                    <span ng-if="budget.discount">{{budget.discount}}</span>
                                </span>
                            </div>

                            <div ng-if="budget.tripType == ETripType.HOTEL">
                                <span>{{trip.beginDate | date: 'MM-dd'}}至{{trip.endDate | date: 'MM-dd'}}(共{{budget.duringDays}}天)</span>
                                <span class="spanRight">
                                    <span ng-if="budget.price && budget.price > 0">
                                        {{budget.price| currency_int}}元
                                    </span>
                                    <span ng-if="!budget.price || budget.price <=0">
                                        暂无预算
                                    </span>
                                </span>
                                <br/>
                                {{trip.destinationPlaceName}}<span ng-if="trip.hotelName">&nbsp;{{trip.hotelName}}附近</span>
                                <span class="spanRight right-budget">
                                    <span ng-if="budget.price && budget.price >0">
                                        {{(budget.price /budget.duringDays| currency_int)+'元/天'}}
                                    </span>
                                </span>
                            </div>

                            <div ng-if="budget.tripType == ETripType.SUBSIDY">
                                <span>{{trip.beginDate | date: 'MM-dd'}}至{{trip.endDate | date: 'MM-dd'}}(共{{budget.duringDays}}天)</span>
                                <span class="spanRight">
                                    {{budget.price| currency_int}}元
                                </span>
                                <br/>
                                <span class="spanRight right-budget">{{budget.price <=0 ? '暂无预算' : (budget.price/ budget.duringDays| currency_int)+'元/天'}}</span>
                            </div>

                            <div ng-if="budget.tripType == ETripType.OUT_TRIP">
                                <span>{{trip.beginDate | date: 'MM-dd'}}</span>
                                <span class="spanRight">
                                    <span ng-if="budget.price && budget.price > 0">
                                        {{(budget.price| currency_int)+'元'}}
                                    </span>
                                    <span ng-if="!budget.price || budget.price <= 0">
                                        暂无预算
                                    </span>
                                </span>
                                <br/>
                                {{trip.originPlaceName}}
                                &nbsp;
                                <i ng-if='budget.type == EInvoiceType.PLANE' class="icon ion-plane"></i>
                                <i ng-if='budget.type == EInvoiceType.TRAIN' class="icon ion-android-train"></i>
                                &nbsp;
                                {{trip.destinationPlaceName}}
                                <span class="spanRight right-budget">
                                    <span>{{budget.type == EInvoiceType.PLANE ? MPlaneLevel[budget.cabinClass] : MTrainLevel[budget.cabinClass]}}
                                    </span>
                                    <span ng-if="budget.discount">{{budget.discount}}</span>
                                </span>
                            </div>
                        </ion-item>
                    </div>
                </ion-list>
            </ion-scroll>
            <div class="bottom-bar-budget">
                <bottom-bar ng-if="!showChooseApproveUser">
                    <button class="button button-positive" ng-click="submitApprove()">生成出差记录</button>
                </bottom-bar>
                <bottom-bar ng-if="staff.company.oa == EApproveChannel.DING_TALK">
                    <div class="status-bar item status-bar-detail">
                        <div class="list">审批将通过钉钉完成</div>
                        <div class="list">请到钉钉查看审批进度</div>
                    </div>
                </bottom-bar>
                <bottom-bar ng-if="showChooseApproveUser && staff.company.oa != EApproveChannel.DING_TALK">
                    <form class="list">
                        <div class="item item-input status-bar status-bar-input">
                            <span class="input-label" ng-if="!trip.auditUser">选择审批人</span>
                            <ng-selector-list
                                    ng-model="trip.auditUser"
                                    dlg-options="staffSelector"
                                    dlg-title=""
                                    dlg-placeholder="请选择审批人"
                                    class="fake-input"
                            ></ng-selector-list>
                            <i class="icon ion-arrow-up-b"></i>
                        </div>
                    </form>
                    <button class="button" ng-if="!totalPrice || totalPrice <= 0">特别审批</button>
                    <button
                            ng-if="totalPrice > 0"
                            class="button"
                            ng-class="{true: 'hasAuditUser button button-outline button-positive',false: ''}[bottomBottomClicked]"
                            ng-click="specialApprove()">
                        特别审批
                    </button>
                    <button class="button" ng-if="!totalPrice || totalPrice <= 0">提交审批</button>
                    <button ng-if="totalPrice > 0"
                            class="button"
                            ng-class="{true: 'hasAuditUser',false: ''}[bottomBottomClicked]"
                            ng-click="submitApprove()">
                            提交审批
                    </button>
                </bottom-bar>
            </div>
        </div>
    </ion-content>
</ion-view>