<ion-view title="行程详情页" id="page20">
    <ion-content padding="false" scroll="false" class="has-header">
        <div class="flex-c10">
            <ion-scroll>
                <!--<tp-status-bar detail="tripDetail" status="tripDetail.status" reason="tripDetail.reason"></tp-status-bar>-->
                <tp-header trip="tripDetail"></tp-header>
                <div class="spacer" style="width: 285px; height: 17px;"></div>
                <div class="button-bar"></div>
                <ion-list>
                    <!--交通条目-->
                    <!--title="{{$index == 0? '交通': ''}}"-->
                    <tp-detail-item ng-repeat="budget in trafficBudgets| orderBy:'createdAt'"
                                    show-uploader="true"
                                    title="交通"
                                    budget="{{totalBudgetObj.trafficTotalBudget | currency: ''}}元"
                                    item="budget"
                                    is-before-start-time="isBeforeStartTime">
                    </tp-detail-item>

                    <!--住宿条目-->
                    <tp-detail-item ng-repeat="budget in hotelBudgets| orderBy:'createdAt'"
                                    show-uploader="true"
                                    title="{{$index == 0? '住宿': ''}}"
                                    budget="{{totalBudgetObj.hotelTotalBudget | currency: ''}}元"
                                    item="budget"
                                    is-before-start-time="isBeforeStartTime">
                    </tp-detail-item>
                    <!--补助-->
                    <tp-detail-item ng-repeat="budget in subsidyBudgets | orderBy:'createdAt'"
                                    show-uploader="true"
                                    title="{{$index == 0? '公司补助': ''}}"
                                    budget="{{totalBudgetObj.subsidyTotalBudget | currency: ''}}元"
                                    item="budget">
                    </tp-detail-item>
                    <!--特别审批-->
                    <tp-detail-item ng-repeat="budget in specialApproveBudgets | orderBy:'createdAt'"
                                    show-uploader="true"
                                    title="{{$index == 0? '特别审批': ''}}"
                                    budget="{{totalBudgetObj.specialApproveTotalBudget | currency: ''}}元"
                                    remark="{{tripDetail.specialApproveRemark}}"
                                    item="budget"
                                    is-before-start-time="isBeforeStartTime">
                    </tp-detail-item>
                </ion-list>
            </ion-scroll>

            <div ng-if="tripDetail && tripDetail.status != undefined" class="bottom-bar-trip">
                <bottom-bar ng-if="tripDetail.status == EPlanStatus.WAIT_UPLOAD">
                    <!--<div class="status-bar item" ng-if="!bottomStyle.isSelect && !bottomStyle.approveDetail">-->
                    <div class="status-bar item">
                        <div class="list" ng-if="isBeforeStartTime">预订/传票据</div>
                        <div class="list" ng-if="!isBeforeStartTime">待传票据</div>
                    </div>
                    <button class="button button_left" ng-if="!hasInvoice" ng-click="cancelTripPlan()" style='color:#28A7E1;background-color:#ffffff;' ng-stat-event="撤销行程">
                        撤销行程
                    </button>
                    <button class="button button_right" style='color:#ffffff;background-color: #D8D8D8'>
                        提交审核
                    </button>
                </bottom-bar>

                <bottom-bar ng-if="tripDetail.status == EPlanStatus.WAIT_COMMIT">
                    <div class="status-bar item">
                        <div class="list" ng-if="isBeforeStartTime">预订/传票据</div>
                        <div class="list" ng-if="!isBeforeStartTime">待传票据</div>
                    </div>
                    <button class="button button_right" ng-click="showAlterDialog()" style='color:#ffffff;background-color: #28A7E1'>
                        提交审核
                    </button>
                </bottom-bar>

                <bottom-bar ng-if="tripDetail.status == EPlanStatus.AUDITING">
                    <div class="status-bar item">
                        <div class="list">票据审核中</div>
                    </div>
                </bottom-bar>

                <bottom-bar ng-if="tripDetail.status == EPlanStatus.AUDIT_NOT_PASS">
                    <div class="status-bar item">
                        <div class="list">审核失败</div>
                    </div>
                    <button class="button button_right" style='color:#ffffff;background-color: #D8D8D8' ng-stat-event="提交审批">
                        提交审核
                    </button>
                </bottom-bar>

                <bottom-bar ng-if="tripDetail.status == EPlanStatus.COMPLETE">
                    <div class="status-bar item">
                        <div class="list">已完成</div>
                    </div>
                    <button ng-if="!hasMakeSpendRecorder" class="button button_right" ng-click="makeSpendReport()" style='color:#ffffff;background-color: #28A7E1' ng-stat-event="生成报销单">
                        生成报销单
                    </button>
                </bottom-bar>

                <bottom-bar ng-if="tripDetail.status == EPlanStatus.CANCEL">
                    <div class="status-bar item">
                        <div class="list">已撤销<span>&nbsp;{{tripDetail.cancelRemark}}</span></div>
                    </div>
                </bottom-bar>

            </div>
        </div>
    </ion-content>
</ion-view>