<ion-view title="行程详情页" id="page20">
    <ion-content padding="false" scroll="false" class="has-header has-bottom-btn">
        <div class="flex_content">
            <ion-scroll>
                <div class="list">
                    <div class="item opactic" ng-if="tripDetail.status != EPlanStatus.APPROVE_NOT_PASS">
                        {{statustext[tripDetail['status']] || '预算审批中'}}
                    </div>
                    <div class="item opactic" ng-if="tripDetail.status == EPlanStatus.APPROVE_NOT_PASS">
                        审批未通过，备注：{{tripDetail.auditRemark}}
                    </div>
                </div>
                <ion-list class="jl_projectinfo">
                    <ion-item class="project_tit">{{tripDetail.title}}</ion-item>
                    <ion-item class="project_cont">
                        <p ng-if="tripDetail && tripDetail.startAt">{{tripDetail.startAt | date: 'yyyy-MM-dd'}} 至 {{tripDetail.backAt | date: 'yyyy-MM-dd'}}</p>
                        <p style="text-align: center">总预算:<span style="font-size: 20px;font-weight: bold;">{{tripDetail.budget == -1 ? '暂无预算' : (tripDetail.budget| currency: '')}}</span>{{tripDetail.budget == -1 ? '' : '元'}}</p>
                    </ion-item>
                </ion-list>
                <div class="spacer" style="width: 285px; height: 17px;"></div>
                <div class="button-bar"></div>
                <ion-list>
                    <div ng-if="goTraffic">
                        <ion-item class="item-divider">
                            <span>交通</span>
                            <span class="spanRight">{{(goTraffic.budget + backTraffic.budget) == -1 ? '暂无预算' : ((goTraffic.budget + backTraffic.budget)| currency: '')}}{{(goTraffic.budget + backTraffic.budget) == -1 ? '' : '元'}}</span>
                        </ion-item>
                        <ion-item>
                            <span>{{goTraffic.startTime | date: 'yyyy-MM-dd'}}</span>
                            <br>
                            {{tripDetail.deptCity}}
                            &nbsp;
                            <i ng-if='goTraffic.invoiceType == EInvoiceType.PLANE' class="icon ion-plane"></i>
                            <i ng-if='goTraffic.invoiceType == EInvoiceType.TRAIN' class="icon ion-android-train"></i>
                            <i ng-if='goTraffic.invoiceType == EInvoiceType.HOTEL' class="icon ion-home"></i>
                            <i ng-if='goTraffic.invoiceType == EInvoiceType.OTHER'>-</i>
                            &nbsp;
                            {{tripDetail.arrivalCity}}
                            <br>{{goTraffic.budget == -1 ? '暂无预算' : (goTraffic.budget| currency: '')+'元'}}
                            <div class="item-note" ng-if="goTraffic.status == EPlanStatus.WAIT_UPLOAD">
                                <div class="uploadbtns button-small botton-outline button-positive" ng-if="tripDetail.status == EPlanStatus.WAIT_UPLOAD || tripDetail.status == EPlanStatus.AUDIT_NOT_PASS"
                                     ng-uploader accept="image/*" title="goTraffic.title" done="goTraffic.done">
                                    上传票据
                                </div>
                                <!--<a ng-if="otherStatus" class="" ng-click="checkInvoice( 'outTraffic' )">查看票据</a>-->
                            </div>
                            <div class="item-note" ng-if="goTraffic.status == EPlanStatus.WAIT_COMMIT">
                                <div class="uploadbtns button-small botton-outline button-positive" ng-uploader accept="image/*" title="goTraffic.title" done="goTraffic.done">
                                    重新上传
                                </div>
                                <a class="button button-small button-outline" ng-click="checkInvoice(goTraffic.id)">查看票据</a>
                            </div>
                            <div class="item-note" ng-if="goTraffic.status == EPlanStatus.AUDITING">
                                <a class="button button-small button-outline" ng-click="checkInvoice(goTraffic.id)">查看票据</a>
                            </div>
                            <div class="item-note" ng-if="goTraffic.status == EPlanStatus.WAIT_APPROVE">
                                待审批
                            </div>
                            <!--<div class="item-note" ng-if="goTraffic.status == EPlanStatus.APPROVE_NOT_PASS">-->
                            <!--审批未通过-->
                            <!--</div>-->
                            <div class="item-note" ng-if="goTraffic.status == EPlanStatus.COMPLETE">
                                <a class="button button-small button-outline" ng-click="checkInvoice(goTraffic.id)">查看票据</a>
                            </div>
                            <div class="item-note" ng-if="goTraffic.status == EPlanStatus.AUDIT_NOT_PASS">
                                <div class="uploadbtns button-small botton-outline button-positive" ng-uploader accept="image/*" title="goTraffic.title" done="goTraffic.done">
                                    重新上传
                                </div>
                            </div>
                            <div class="item-note" ng-if="goTraffic.status == EPlanStatus.NO_BUDGET">
                                <a class="button button-small button-outline" ng-click="checkInvoice(goTraffic.id)">查看票据</a>
                            </div>
                        </ion-item>
                    </div>
                    <div ng-if="backTraffic">
                        <ion-item>
                            <span>{{backTraffic.startTime | date: 'yyyy-MM-dd'}}</span>
                            <br>
                            {{tripDetail.arrivalCity}}
                            &nbsp;
                            <i ng-if='backTraffic.invoiceType == EInvoiceType.PLANE' class="icon ion-plane"></i>
                            <i ng-if='backTraffic.invoiceType == EInvoiceType.TRAIN' class="icon ion-android-train"></i>
                            <i ng-if='backTraffic.invoiceType == EInvoiceType.HOTEL' class="icon ion-home"></i>
                            <i ng-if='backTraffic.invoiceType == EInvoiceType.OTHER'>-</i>
                            &nbsp;
                            {{tripDetail.deptCity}}
                            <br>{{backTraffic.budget == -1 ? '暂无预算' : (backTraffic.budget| currency: '')+'元'}}
                            <div class="item-note" ng-if="backTraffic.status == EPlanStatus.WAIT_UPLOAD">
                                <div class="uploadbtns button-small botton-outline button-positive"
                                     ng-if="tripDetail.status == EPlanStatus.WAIT_UPLOAD || tripDetail.status == EPlanStatus.AUDIT_NOT_PASS"
                                     ng-uploader accept="image/*" title="backTraffic.title" done="backTraffic.done">
                                    上传票据
                                </div>
                                <!--<a ng-if="otherStatus" class="" ng-click="checkInvoice( 'outTraffic' )">查看票据</a>-->
                            </div>
                            <div class="item-note" ng-if="backTraffic.status == EPlanStatus.WAIT_COMMIT">
                                <div class="uploadbtns button-small botton-outline button-positive" ng-uploader accept="image/*" title="backTraffic.title" done="backTraffic.done">
                                    重新上传
                                </div>
                                <a class="button button-small button-outline" ng-click="checkInvoice(backTraffic.id)">查看票据</a>
                            </div>
                            <div class="item-note" ng-if="backTraffic.status == EPlanStatus.AUDITING">
                                <a class="button button-small button-outline" ng-click="checkInvoice(backTraffic.id)">查看票据</a>
                            </div>
                            <div class="item-note" ng-if="backTraffic.status == EPlanStatus.WAIT_APPROVE">
                                待审批
                            </div>
                            <!--<div class="item-note" ng-if="backTraffic.status == EPlanStatus.APPROVE_NOT_PASS">-->
                            <!--审批未通过-->
                            <!--</div>-->
                            <div class="item-note" ng-if="backTraffic.status == EPlanStatus.COMPLETE">
                                <a class="button button-small button-outline" ng-click="checkInvoice(backTraffic.id)">查看票据</a>
                            </div>
                            <div class="item-note" ng-if="backTraffic.status == EPlanStatus.AUDIT_NOT_PASS">
                                <div class="uploadbtns button-small botton-outline button-positive" ng-uploader accept="image/*" title="backTraffic.title" done="backTraffic.done">
                                    重新上传
                                </div>
                            </div>
                            <div class="item-note" ng-if="backTraffic.status == EPlanStatus.NO_BUDGET">
                                <a class="button button-small button-outline" ng-click="checkInvoice(backTraffic.id)">查看票据</a>
                            </div>
                        </ion-item>
                    </div>
                    <div ng-if="hotel">
                        <ion-item class="item-divider">
                            <span>住宿</span>
                            <span class="spanRight">{{hotel.budget == -1 ? '暂无预算' : (hotel.budget| currency: '')}}{{hotel.budget == -1 ? '' : '元'}}</span>
                        </ion-item>
                        <ion-item>
                            <span>{{hotel.startTime | date: 'yyyy-MM-dd'}}</span> 至
                            <span>{{hotel.endTime | date: 'yyyy-MM-dd'}}</span>
                            <br>
                            {{tripDetail.arrivalCity}}&nbsp;{{hotel.hotelName}}
                            <br>{{hotel.budget == -1 ? '暂无预算' : (hotel.budget| currency: '')+'元'}}
                            <div class="item-note" ng-if="hotel.status == EPlanStatus.WAIT_UPLOAD">
                                <div class="uploadbtns button-small botton-outline button-positive"
                                     ng-if="tripDetail.status == EPlanStatus.WAIT_UPLOAD || tripDetail.status == EPlanStatus.AUDIT_NOT_PASS"
                                     ng-uploader accept="image/*" title="hotel.title" done="hotel.done">
                                    上传票据
                                </div>
                                <!--<a ng-if="otherStatus" class="" ng-click="checkInvoice( 'outTraffic' )">查看票据</a>-->
                            </div>
                            <div class="item-note" ng-if="hotel.status == EPlanStatus.WAIT_COMMIT">
                                <div class="uploadbtns button-small botton-outline button-positive" ng-uploader accept="image/*" title="hotel.title" done="hotel.done">
                                    重新上传
                                </div>
                                <a class="button button-small button-outline" ng-click="checkInvoice(hotel.id)">查看票据</a>
                            </div>
                            <div class="item-note" ng-if="hotel.status == EPlanStatus.AUDITING">
                                <a class="button button-small button-outline" ng-click="checkInvoice(hotel.id)">查看票据</a>
                            </div>
                            <div class="item-note" ng-if="hotel.status == EPlanStatus.WAIT_APPROVE">
                                待审批
                            </div>
                            <!--<div class="item-note" ng-if="hotel.status == EPlanStatus.APPROVE_NOT_PASS">-->
                            <!--审批未通过-->
                            <!--</div>-->
                            <div class="item-note" ng-if="hotel.status == EPlanStatus.COMPLETE">
                                <a class="button button-small button-outline" ng-click="checkInvoice(hotel.id)">查看票据</a>
                            </div>
                            <div class="item-note" ng-if="hotel.status == EPlanStatus.AUDIT_NOT_PASS">
                                <div class="uploadbtns button-small botton-outline button-positive" ng-uploader accept="image/*" title="hotel.title" done="hotel.done">
                                    重新上传
                                </div>
                            </div>
                            <div class="item-note" ng-if="hotel.status == EPlanStatus.NO_BUDGET">
                                <a class="button button-small button-outline" ng-click="checkInvoice(hotel.id)">查看票据</a>
                            </div>
                        </ion-item>
                    </div>
                    <div ng-if='other'>
                        <ion-item class="item-divider">
                            <span>补助</span>
                            <span class="spanRight">{{other.budget == -1 ? '暂无预算' : (other.budget| currency: '')}}{{other.budget == -1 ? '' : '元'}}</span>
                        </ion-item>
                        <ion-item class="">
                            <span>{{tripDetail.startAt | date: 'yyyy-MM-dd'}}</span> 至
                            <span>{{tripDetail.backAt | date: 'yyyy-MM-dd'}}</span>
                            <br>{{other.budget == -1 ? '暂无预算' : (other.budget| currency: '')+ '元'}}
                        </ion-item>
                    </div>
                </ion-list>
            </ion-scroll>
        </div>
        <div class="button-bar flex_footer">
            <a ng-if="tripDetail.status == EPlanStatus.WAIT_COMMIT" ng-click="approveTripPlan()" id="page20-button60" class="button button-positive" no-back>提交审核</a>
            <a ng-if="tripDetail.status == EPlanStatus.WAIT_UPLOAD" class="button button-stable" no-back>提交审核</a>
            <a ng-if="tripDetail.status == EPlanStatus.APPROVE_NOT_PASS" ng-click="createTripPlan()" id="page20-button61" class="button button-positive" no-back>再次生成</a>
        </div>
    </ion-content>
</ion-view>