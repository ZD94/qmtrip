<ion-view title="审批单详情" id="page7">
    <ion-content ng-hide="isConfirm" padding="false" scroll="false" class="has-header">
        <div class="flex-c10">
            <ion-scroll>
                <!--<ta-status-bar approve="tripApprove"></ta-status-bar>-->

                <ion-list ng-if="!isSelf">
                    <tp-staff-detail staff="staff"></tp-staff-detail>
                    <div class="spacer" style="width: 285px; height: 17px;"></div>
                </ion-list>
                <ta-header approve="tripApprove"></ta-header>

                <div class="spacer" style="width: 285px; height: 17px;"></div>

                <div ng-if="tripApprove.isSpecialApprove">
                    <ion-item class="item-divider">
                        <span>{{tripApprove.deptCity}} - {{tripApprove.arrivalCity}}</span>
                    </ion-item>
                    <ion-item>
                        <p style="white-space: initial;">{{tripApprove.specialApproveRemark}}</p>
                        <span>{{tripApprove.budget| currency: ''}}元</span>
                    </ion-item>
                </div>

                <div ng-if="!tripApprove.isSpecialApprove">
                    <!--交通-->
                    <ta-detail-item ng-repeat="t in traffic track by t.id"
                                    item="t" title="交通"
                                    budget="{{trafficBudget| currency: ''}}元">
                    </ta-detail-item>
                    <!--酒店-->
                    <ta-detail-item ng-repeat="h in hotel track by h.id"
                                    item="h"
                                    title="{{$index == 0 ? '住宿': ''}}"
                                    budget="{{hotelBudget | currency: ''}}元">
                    </ta-detail-item>
                    <!--补助-->
                    <ta-detail-item ng-repeat="s in subsidy track by s.id"
                                    item="s"
                                    title="补助"
                                    budget="{{subsidyBudget| currency: ''}}元">
                    </ta-detail-item>
                </div>


            </ion-scroll>

            <div class="bottom-bar-approval">
                <bottom-bar ng-if="tripApprove.status == EApproveStatus.WAIT_APPROVE">
                    <div class="status-bar item status-bar-detail" ng-click="approveDetail()">
                        <div class="list">等待{{tripApprove.approveUser.name}}审批</div>
                        <div class="list">查看审批详情</div>
                    </div>
                    <button class="button button_left" ng-if="isHasPermissionApprove" ng-click="showReasonDialog()" style='color:#ffffff;background-color: #D0021B;'>驳回
                    </button>
                    <button class="button button_right" ng-if="isHasPermissionApprove" ng-click="confirmButton()" style='color:#ffffff;background-color: #28A7E1'>同意
                    </button>
                    <button class="button button_right" ng-if="!isHasApprove && !isHasPermissionApprove"
                            ng-click="cancelTripApprove()" style='color:#28A7E1;background-color: #ffffff'>撤销行程
                    </button>
                </bottom-bar>
                <bottom-bar ng-if="tripApprove.status == EApproveStatus.REJECT">
                    <div class="status-bar item status-bar-detail" ng-click="approveDetail()">
                        <div class="list"><span style="color: red">审批驳回</span><span>&nbsp;{{tripApprove.approveRemark}}</span></div>
                        <div class="list">查看审批详情</div>
                    </div>
                    <button class="button button_right" ng-click="reCommitTripApprove()" ng-if="!isHasPermissionApprove"
                            style='color:#ffffff;background-color: #D0021B'>重新提交
                    </button>
                </bottom-bar>
                <bottom-bar ng-if="tripApprove.status == EApproveStatus.PASS">
                    <div class="status-bar item status-bar-detail" ng-click="approveDetail()">
                        <div class="list">审批通过</div>
                        <div class="list">查看审批详情</div>
                    </div>
                    <button ng-if="!isHasPermissionApprove" class="button button_right" ng-click="checkTrip()" style='color:#ffffff;background-color: #28A7E1'>查看行程
                    </button>
                </bottom-bar>
                <bottom-bar ng-if="tripApprove.status == EApproveStatus.CANCEL">
                    <div class="status-bar item status-bar-detail" ng-click="approveDetail()">
                        <div class="list">已撤销<span>&nbsp;{{tripApprove.cancelRemark}}</span></div>
                        <div class="list">查看审批详情</div>
                    </div>
                </bottom-bar>
            </div>
        </div>
    </ion-content>
</ion-view>