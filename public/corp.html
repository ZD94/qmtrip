<!DOCTYPE html>
<html lang="zh-cn">
<html ng-app="tulingdao.com">
<head>
	<meta charset="UTF-8">
	<title ng-bind="pageTitle"></title>
	<link rel="stylesheet" type="text/css" href="/corp/css/common.css">
	<link rel="stylesheet" type="text/css" href="/corp/css/public.css">
	<script type="text/javascript" src="/script/libs/bundle.jquery.js"></script>
	<script type="text/javascript">
        var jQuery = $ = require('jquery');
    </script>
    <script type="text/javascript" src="/script/libs/bundle.angular.js"></script>
    <script type="text/javascript" src="/script/libs/bundle.api.js"></script>
    <script type="text/javascript" src="/script/libs/api.js"></script>
    <script type="text/javascript" src="/script/libs/ngapp.js"></script>
    <script type="text/javascript" src="/script/messagebox.js"></script>
    <script type="text/javascript" src="/script/header.js"></script>
    <script type="text/javascript" src="/corp/controller.all.js"></script>
    <script type="text/javascript">
    	var Q = require('q');
    	var moment = require('moment');
    	var TLD = TLD_angular_app('tulingdao.com', 'corp', '/users/user-main');
    	// API.onlogin(function(){
    	// 	window.location.href = "/";
    	// 	return;
    	// })
    	//获取页面基本信息
    	TLD.controller("MainController", ["$scope", function($scope) {
    		API.require("company");
    		API.require("staff");
    		API.onload(function(){
    			API.staff.getCurrentStaff()
    				.then(function(ret){
    					$scope.staff = ret.staff;
    					var company_id = ret.staff.companyId;
    					console.info(ret);
    					API.company.getCompany(company_id)
		    				.then(function(company){
		    					$scope.company = company.company;
		    					console.info(company);
		    					$scope.$apply();
		    				})
		    				.catch(function(err){
		    					console.info(err)
		    				})
    					$scope.$apply();
    				})
    				.catch(function(err){
    					console.info(err)
    				})
    			.done
    		})
    	}])
    </script>
    <script type="text/javascript">
    $(function(){
    	$(window).resize(function(){resize();})
    	$(".left_nav a").click(function(){
    		var $that = $(this);
    		$(".left_nav li").removeClass("on");
    		$that.addClass("on");
    	})
    	function resize(){
    		var ww = $(window).width();
    		$(".corp_m_header").css("width",ww-200);
    	}
    	resize();
    	$()
    })
    </script>
</head>
<body ng-controller="MainController">
	<div class="corp_header">
		<img src="/corp/images/logo_c.png">
		<ul class="left_nav">
			<li class="on">
				<a href="">差旅管理首页</a>
			</li>
			<li>
				<a href="">出差统计</a>
			</li>
			<li>
				<a href="">员工信息管理</a>
			</li>
			<li>
				<a href="">差旅标准设置</a>
			</li>
			<li>
				<a href="">员工奖励计划</a>
			</li>
		</ul>
	</div>
	<div class="corp_main">
		<div class="corp_m_header">
			<div class="m_headerleft">
				<div class="corp_name">{{company.name}}</div>
				<div class="corp_help">帮助</div>
			</div>
			<div class="m_headerright">
				<span class="header_account" id="account">您好，<a href="">{{staff.name}}</a><em class="web-icon-font">&#xf0d7;</em></span>
				<div id="account_menu" class="account_menu">
					<ul>
						<li><a href="">修改密码</a></li>
						<li><a href="">退出</a></li>
					</ul>
				</div>
				<a href="" class="getplan">出差计划</a>
			</div>
		</div>
		<div class="corp_box">
			<div id="angular-view" ng-view></div>
		</div>
		<div class="corp_m_footer">
			
		</div>
	</div>
</body>
</html>