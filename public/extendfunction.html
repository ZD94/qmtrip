<!DOCTYPE html>
<html lang="zh-cn">
<html ng-app="tulingdao.com">
<head>
	<meta charset="UTF-8">
	<title ng-bind="pageTitle"></title>
	<link rel="stylesheet" type="text/css" href="/staff/css/common.css">
	<link rel="stylesheet" type="text/css" href="/staff/css/public.css">
	<link rel="stylesheet" type="text/css" href="/extendfunction/css/feedback.css">
	<script type="text/javascript" src="/script/libs/bundle.jquery.js"></script>
    <script type="text/javascript">
        var jQuery = $ = require('jquery');
    </script>
	<script type="text/javascript" src="/script/libs/bundle.browserify.js"></script>
	<script type="text/javascript" src="/script/libs/bundle.base.js"></script>
	<script type="text/javascript" src="/script/libs/bundle.api.js"></script>
	<script type="text/javascript" src="/script/jqPaginator.js"></script>
	<script type="text/javascript" src="/script/libs/bundle.angular.js"></script>
	<script type="text/javascript" src="/script/libs/bundle.nglibs.js"></script>
	<script type="text/javascript" src="/script/libs/bundle.ngapp.js"></script>
	<script src="http://echarts.baidu.com/build/dist/echarts-all.js"></script>
	<script type="text/javascript" src="/script/libs/bundle.msgbox.js"></script>
    <script type="text/javascript" src="/script/selectbox.js"></script>
    <script type="text/javascript" src="/script/header.js"></script>
    <script type="text/javascript" src="/script/jquery.ajaxfileupload.js"></script>
    <script type="text/javascript" src="/extendfunction/controller.all.js"></script>
    <script type="text/javascript">
    	var moment = require('moment');
		var Cookie = require('tiny-cookie');
		var TLD = TLD_angular_app('tulingdao.com', 'extendfunction', '/feedback');
//		API.onlogin(function(){
//			var backUrl = window.location.href;
//			backUrl = encodeURIComponent(backUrl);
//			window.location.href = "/staff.html#/auth/login?backurl="+backUrl;
//		});
		API.authenticate = function(remote, callback){
			var user_id = Cookie.get('user_id');
			var token_id = Cookie.get('token_id');
			var token_sign = Cookie.get('token_sign');
			var timestamp = Cookie.get("timestamp");
			remote.authenticate({ accountid: user_id, tokenid: token_id, tokensign: token_sign, timestamp: timestamp },
					callback);
		};
//		function logout(){
//			API.require('auth');
//			API.onload(function(){
//				API.auth.logout()
//						.done(function() {
//							window.location.href = "/staff.html#/auth/login";
//						});
//			});
//		};
    	//获取页面基本信息
    	TLD.controller("MainController", ["$scope", function($scope) {
    		API.require("company");
    		API.require("staff");
			var companyId;
    		API.onload(function(){
    			API.staff.getCurrentStaff()
    				.then(function(ret){
    					$scope.staff = ret;
//    					var company_id = ret.companyId;
//							companyId = company_id;
//    					return API.company.getCompanyById(company_id)
//		    				.then(function(company){
//		    					$scope.company = company;
//		    					var companyName = company.name;
//		    					if (companyName.length>30) {
//		    						$scope.companyName = companyName.substr(0,29) + '…';
//		    					}else{
//		    						$scope.companyName = companyName;
//		    					}
//		    				})
    				})
    				.catch(function(err){
    					TLDAlert(err);
    				})
    		})
    	}])
    </script>
    <script type="text/javascript">
    $(function(){
    	$(window).resize(function(){resize();})
    	function resize(){
    		var ww = $(window).width();
    		$(".corp_m_header").css("width",ww-200);
    	}
    	resize();
    	$()
    })
    </script>
</head>
<body ng-controller="MainController">
<div class="staff_header">
	<div class="s_header_main">
		<div class="staff_logo">
			<a href="staff.html">
				<img src="staff/images/qmtrip.png">
			</a>
		</div>


	</div>
</div>
<div class="staff_content" style="background-color: #f5f5f5;">
	<div class="s_contentmain" ui-view>
	</div>
	<div id="loading" style="text-align: center;position: fixed;top: 0;left: 0;bottom:0;right:0;display: none;background:#2d2d2d;opacity:.5">
		<div style="text-align: center;position: absolute;top: 35%;left: 48%;"><img src="/images/data-loading.gif" style="width: 30px;"/></div>
	</div>

</div>
<div class="footer">
	<p>由途灵岛（北京）信息技术股份有限公司提供技术支持&nbsp; &nbsp;联系电话：010-57371105</p>
	<p>Copyright©2016 tulingdao.All Rights Reserved.京ICP备14028756号.途灵岛信息技术版权所有</p>
</div>
	<script type="text/javascript" src="/script/messagebox.js"></script>
</body>
</html>