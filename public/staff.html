<!DOCTYPE html>
<html ng-app="qmtrip.staff">
<head>
	<meta charset="UTF-8">
	<title ng-bind="pageTitle"></title>
	<link rel="stylesheet" type="text/css" href="/staff/css/public.css">
	<link rel="stylesheet" type="text/css" href="/staff/css/businesstravel.css">
	<link rel="stylesheet" type="text/css" href="/staff/css/travelplan.css">
	<link rel="stylesheet" type="text/css" href="/staff/css/users.css">
	<link rel="stylesheet" type="text/css" href="/staff/css/auth.css"/>
	<script type="text/javascript" src="/script/libs/bundle.jquery.js"></script>
    <script type="text/javascript">
        var jQuery = $ = require('jquery');
        require('jquery-ui');
    </script>
    <script type="text/javascript" src="/script/libs/bundle.api.js"></script>
    <script type="text/javascript" src="/script/libs/bundle.ngapp.js"></script>
    <script type="text/javascript" src="/script/messagebox.js"></script>
    <script type="text/javascript" src="/script/selectbox.js"></script>
    <script type="text/javascript" src="/script/jquery.ajaxfileupload.js"></script>
    <script type="text/javascript" src="/script/header.js"></script>
    <script type="text/javascript" src="/staff/controller.all.js"></script>

    <script type="text/javascript">
        var Q = require('q');
        var moment = require('moment');
        console.info(moment().startOf('Month').format('D'));
        console.info(moment().endOf('Month').format('D'));
        var Cookie = require('tiny-cookie');
        var TLD = TLD_angular_app('qmtrip.staff');
        TLD.config(function ($stateProvider, $urlRouterProvider) {
            $urlRouterProvider.otherwise('/StaffFirst/StaffUser');
            $stateProvider
                    .state("auth", {
                        url: "/auth/:path",
                        controllerProvider: function ($injector, $stateParams){
                            $stateParams.path = 'auth/' + $stateParams.path;
                            return $injector.invoke(TLD_angular_app_defaultControllerProvider, this, {$stateParams:$stateParams});
                        },
                        templateUrl: function (params) {
                            return '/staff/auth/' + params.path + ".html";
                        }
                    })
                    .state("root", {
                        url: "",
                        abstract: true,
                        controllerProvider: TLD_angular_app_defaultControllerProvider,
                        templateUrl: function (params) {
                            return '/staff/index.html';
                        }
                    })
                    .state("root.content", {
                        url: "/*path",
                        controllerProvider: TLD_angular_app_defaultControllerProvider,
                        templateUrl: function (params) {
                            return '/staff/' + params.path + ".html";
                        }
                    });
        });
        API.onlogin(function () {
            var backUrl = window.location.href;
            backUrl = encodeURIComponent(backUrl);
            window.location.href = "/staff.html#/auth/login?backurl=" + backUrl;
        });
        API.authenticate = function(remote, callback){
            var user_id = Cookie.get('user_id');
            var token_id = Cookie.get('token_id');
            var token_sign = Cookie.get('token_sign');
            var timestamp = Cookie.get("timestamp");
            remote.authenticate({ accountid: user_id, tokenid: token_id, tokensign: token_sign, timestamp: timestamp },
                    callback);
        };
        // function logout(){
        // 	API.require('auth');
        // 	API.onload(function(){
        // 		API.auth.logout()
        // 				.then(function (data) {
        // 					location.reload();
        // 				}).catch(function(error){
        // 			console.log(error);
        // 		}).done();
        // 	});
        // };
    </script>
</head>
<body>
<div id="angular-view" ui-view></div>
<div class="footer">
    <p>由途灵岛信息股份有限公司提供技术支持</p>
    <p>联系电话：010-57371105</p>
</div>
</body>
</html>