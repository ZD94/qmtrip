<!DOCTYPE html>
<html lang="zh-cn">
<html ng-app="tulingdao.com">
<head>
	<meta charset="UTF-8">
	<title ng-bind="pageTitle"></title>
    <link rel="stylesheet" type="text/css" href="/staff/css/public.css">
	<link rel="stylesheet" type="text/css" href="/staff/css/users.css">
	<script type="text/javascript" src="/script/libs/bundle.jquery.js"></script>
	<script type="text/javascript">
        var jQuery = $ = require('jquery');
    </script>
    <script type="text/javascript" src="/script/libs/bundle.angular.js"></script>
    <script type="text/javascript" src="/script/libs/bundle.api.js"></script>
    <script type="text/javascript" src="/script/libs/api.js"></script>
    <script type="text/javascript" src="/script/libs/ngapp.js"></script>
    <script type="text/javascript" src="/script/messagebox.js"></script>
    <script type="text/javascript" src="/script/header.js"></script>
    <script type="text/javascript" src="/staff/controller.all.js"></script>
    <script type="text/javascript">
    	var Q = require('q');
    	var moment = require('moment');
    	var TLD = TLD_angular_app('tulingdao.com', 'staff', '/StaffFirst/StaffUser');
    	API.onlogin(function(){
    		window.location.href = "/auth.html?backurl="+encodeURIComponent(window.location.href);
    		return;
    	})
    	//获取页面基本信息
    	TLD.controller("MainController", ["$scope", function($scope) {
    		API.require("staff");
            API.require("auth");
    		API.onload(function(){
    			API.staff.getCurrentStaff()
    				.then(function(ret){
    					$scope.staff = ret.staff;
    					$scope.$apply();
    				})
    				.catch(function(err){
    					console.info(err)
    				})
                $scope.logout = function(){
                    API.auth.logout()
                        .then(function(ret){
                            window.location.href = "/auth.html#/auth/login?backurl="+encodeURIComponent(window.location.href);
                        })
                        .catch(function(err){
                            console.info(err)
                        })
                }
    		})
            
    	}])
    </script>
    <script type="text/javascript">
    $(function(){
    	$(".staff_menu_t a li").click(function(){
    		var $that = $(this);
    		$(".staff_menu_t li").removeClass("on");
    		$that.addClass("on");
    	})
    })
    </script>
</head>
<body ng-controller="MainController">
	<div class="staff_header">
		<div class="s_header_main">
			<div class="staff_logo">
				<a href="/">
					<img src="staff/images/qmtrip.png">
				</a>
			</div>
			<div class="staff_menu_t">
				<ul>
					<a href=""><li class="on">首页</li></a>
					<a href=""><li>出差记录</li></a>
					<a href=""><li>积分兑换</li></a>
                    <a href=""><li>我要出差</li></a>
					<!-- <a href="" class="tobusiness">我要出差</a> -->
				</ul>
			</div>
			<div class="staff_header_r">
				<span class="header_account" id="account">您好，<a href="">{{staff.name}}</a><em class="web-icon-font">&#xf0d7;</em></span>
				<div id="account_menu" class="account_menu">
					<ul>
						<li><a href="">修改密码</a></li>
						<li><a ng-click="logout()">退出</a></li>
					</ul>
				</div>
			</div>
		</div>
	</div>
	<div class="staff_content">
		<div class="s_contentmain" id="angular-view" ng-view>
		</div>
	</div>
	<div class="footer">
		<p>由途灵岛信息股份有限公司提供技术支持</p>
		<p>联系电话：010-57371105</p>
	</div>
</body>
</html>